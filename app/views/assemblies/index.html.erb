<% eurokurs = 1.2 %>
<h1>Alle IO-Baugruppen</h1>
<br>
<a href="<%=new_assembly_path%>" class="btn btn-success">Neue IO-Baugruppe erstellen</a>
<br><br><br><br><h4>Import from CSV</h4>
<%= form_tag import_assemblies_path, multipart: true do %>
    <div class="actions form-group">
      <%= file_field_tag :file, class: 'form-control' %><br>
      <%= submit_tag "Import CSV", class: "btn btn-success" %>
    </div>
<% end %><br>

<div id="content" class="table-responsive">
  <% if Assembly.any? %>
    <table class="table table-striped table-bordered" cellspacing="0" width="100%">
      <thead>
        <tr>
          <th>Kennung</th>
          <th>Kanäle</th>
          <th>Bezeichnung</th>
          <th>Brutto [CHF]</th>
          <th>Rabatt</th>
          <th>Netto [CHF]</th>
          <th>Anzahl Baugruppen</th>
          <th>Reserve</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>DI</td>
          <td>1</td>
          <td>Digitaler Eingang auf ET200SP</td>
          <td><%= Assembly.di_brutto_chf(eurokurs) %></td>
          <td><%= Assembly.di_rabatt %></td>
          <td><%= Assembly.di_netto_chf(eurokurs) %></td>
          <td><%= Assembly.di_anz_bg %></td>
          <td><%= Assembly.di_reserve %></td>
        </tr>
        <tr>
          <td>DO</td>
          <td>1</td>
          <td>Digitaler Ausgang auf ET200SP</td>
          <td><%= Assembly.do_brutto_chf(eurokurs) %></td>
          <td><%= Assembly.do_rabatt %></td>
          <td><%= Assembly.do_netto_chf(eurokurs) %></td>
          <td><%= Assembly.do_anz_bg %></td>
          <td><%= Assembly.do_reserve %></td>
        </tr>
        <tr>
          <td>AI</td>
          <td>1</td>
          <td>Analoger Eingang auf ET200SP</td>
          <td><%= Assembly.ai_brutto_chf(eurokurs) %></td>
          <td><%= Assembly.ai_rabatt %></td>
          <td><%= Assembly.ai_netto_chf(eurokurs) %></td>
          <td><%= Assembly.ai_anz_bg %></td>
          <td><%= Assembly.ai_reserve %></td>
        </tr>
        <tr>
          <td>AO</td>
          <td>1</td>
          <td>Analoger Ausgang auf ET200SP</td>
          <td><%= Assembly.ao_brutto_chf(eurokurs) %></td>
          <td><%= Assembly.ao_rabatt %></td>
          <td><%= Assembly.ao_netto_chf(eurokurs) %></td>
          <td><%= Assembly.ao_anz_bg %></td>
          <td><%= Assembly.ao_reserve %></td>
        </tr>
        <tr>
          <td>Z</td>
          <td>1</td>
          <td>Encoder Inkremental auf ET200SP</td>
          <td><%= Assembly.z_brutto_chf(eurokurs) %></td>
          <td><%= Assembly.z_rabatt %></td>
          <td><%= Assembly.z_netto_chf(eurokurs) %></td>
          <td><%= Assembly.z_anz_bg %></td>
          <td><%= Assembly.z_reserve %></td>
        </tr>
        <tr>
          <td>INKR</td>
          <td>1</td>
          <td>Encoder Inkremental auf ET200SP</td>
          <td><%= Assembly.inkr_brutto_chf(eurokurs) %></td>
          <td><%= Assembly.inkr_rabatt %></td>
          <td><%= Assembly.inkr_netto_chf(eurokurs) %></td>
          <td><%= Assembly.inkr_anz_bg %></td>
          <td><%= Assembly.inkr_reserve %></td>
        </tr>
        <tr>
          <td>SSI</td>
          <td>1</td>
          <td>Encoder SSI auf ET200SP</td>
          <td><%= Assembly.ssi_brutto_chf(eurokurs) %></td>
          <td><%= Assembly.ssi_rabatt %></td>
          <td><%= Assembly.ssi_netto_chf(eurokurs) %></td>
          <td><%= Assembly.ssi_anz_bg %></td>
          <td><%= Assembly.ssi_reserve %></td>
        </tr>
        <tr>
          <td>sDI</td>
          <td>1</td>
          <td>Digitaler Eingang auf PNOZmulti</td>
          <td><%= Assembly.sdi_brutto_chf(eurokurs) %></td>
          <td><%= Assembly.sdi_rabatt %></td>
          <td><%= Assembly.sdi_netto_chf(eurokurs) %></td>
          <td></td>
          <td><%= Assembly.sdi_reserve %></td>
        </tr>
        <tr>
          <td>sDO</td>
          <td>1</td>
          <td>Digitaler Ausgang auf PNOZmulti</td>
          <td><%= Assembly.sdo_brutto_chf(eurokurs) %></td>
          <td><%= Assembly.sdo_rabatt %></td>
          <td><%= Assembly.sdo_netto_chf(eurokurs) %></td>
          <td></td>
          <td><%= Assembly.sdo_reserve %></td>
        </tr>
        <tr>
          <td>sAI</td>
          <td>1</td>
          <td>Analoger Eingang auf PNOZmulti</td>
          <td><%= Assembly.sai_brutto_chf(eurokurs) %></td>
          <td><%= Assembly.sai_rabatt %></td>
          <td><%= Assembly.sai_netto_chf(eurokurs) %></td>
          <td></td>
          <td><%= Assembly.sai_reserve %></td>
        </tr>
        <tr>
          <td>sAO</td>
          <td>1</td>
          <td>Analoger Ausgang auf PNOZmulti</td>
          <td><%= Assembly.sao_brutto_chf(eurokurs) %></td>
          <td><%= Assembly.sao_rabatt %></td>
          <td><%= Assembly.sao_netto_chf(eurokurs) %></td>
          <td></td>
          <td><%= Assembly.sao_reserve %></td>
        </tr>
      <tbody>
    </table>
    <br><br><br><br><br>


    <table id="assembly_table" class="table table-striped table-bordered data_table" cellspacing="0" width="100%">
      <thead>
      <tr>
        <th>ID</th>
        <th>Kennung</th>
        <th>Artikel-Nr.</th>
        <th>Bezeichnung</th>
        <th>Kanäle Total</th>
        <th>DI</th>
        <th>DO</th>
        <th>AI</th>
        <th>AO</th>
        <th>Z</th>
        <th>INKR</th>
        <th>SSI</th>
        <th>sDI</th>
        <th>sDO</th>
        <th>sAI</th>
        <th>sAO</th>
        <th>Brutto [EUR]</th>
        <th>Brutto [CHF]</th>
        <th>Rabatt</th>
        <th>Netto [CHF]</th>
        <th>Aktionen</th>
      </tr>
      </thead>
      <tbody>
        <% @assemblies.each do |assembly| %>
          <tr>
            <td><%= assembly.id %></td>
            <td><a href="<%= assembly_path(assembly.id) %>"><%= assembly.kennung %></a></td>
            <td><%= assembly.artikelnr %></td>
            <td><%= truncate(assembly.bezeichnung, :length => 50) %></td>
            <td><%= assembly.kanaele_total %></td>
            <td><%= assembly.di %></td>
            <td><%= assembly.do %></td>
            <td><%= assembly.ai %></td>
            <td><%= assembly.ao %></td>
            <td><%= assembly.z %></td>
            <td><%= assembly.inkr %></td>
            <td><%= assembly.ssi %></td>
            <td><%= assembly.sdi %></td>
            <td><%= assembly.sdo %></td>
            <td><%= assembly.sai %></td>
            <td><%= assembly.sao %></td>
            <td><%= assembly.brutto_eur_col(eurokurs) %></td>
            <td><%= assembly.brutto_chf_col(eurokurs) %></td>
            <td><%= assembly.rabatt %></td>
            <td><%= assembly.netto(eurokurs) %></td>
            <td>
              <a href="<%= assembly_path(assembly.id) %>" class="btn btn-xs btn-default btn-index">Info</a>
              <a href="<%= edit_assembly_path(assembly.id) %>" class="btn btn-xs btn-info btn-index">Bearbeiten</a>
              <button type="button" class="btn btn-xs btn-danger btn-index"
                      data-toggle="modal" data-target="#popup_sure_delete"
                      data-itemid="<%= assembly.id %>"
                      data-model="assemblies">
                Baugruppe löschen
              </button>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  <% else %>
    Keine IO-Baugruppen vorhanden
  <% end %>
</div>

<%= render 'layouts/loading', :message => "Lade IO-Baugruppen..." %>
<%= render 'layouts/popups' %>