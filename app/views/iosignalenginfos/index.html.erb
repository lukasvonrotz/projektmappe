<h1>Alle Eng-Infos zu Signale in <%= @subsubproject.name %></h1>
<br>
<% if @iosignals.length == 0 %>
    Keine IO-Signale zu dieser Version vorhanden!
<% else %>
    <div id="content" class="table-responsive">
      <table id="iosignalenginfo_table" class="table table-striped table-bordered" cellspacing="0" width="100%">
        <thead>
        <tr>
          <th rowspan="2">Editieren</th>
          <th rowspan="2">Tagname</th>
          <th colspan="6" class="success">Pendenz</th>
          <th colspan="6" class="warning">Frage</th>
          <th colspan="6" class="info">SW Instruction</th>
          <th rowspan="2">Aktionen</th>
        </tr>
        <tr>
          <th>Pendenz</th>
          <th>Datum</th>
          <th>Wer?</th>
          <th>Antwort</th>
          <th>Antwort Datum</th>
          <th>Antwort Wer?</th>
          <th>Frage</th>
          <th>Datum</th>
          <th>Wer?</th>
          <th>Antwort</th>
          <th>Antwort Datum</th>
          <th>Antwort Wer?</th>
          <th>SW Instruktion</th>
          <th>SW Instruktion Datum</th>
          <th>SW Instruktion Wer?</th>
          <th>Antwort</th>
          <th>Antwort Datum</th>
          <th>Antwort Wer?</th>
        </tr>
        </thead>
        <tbody>
        <% @iosignalenginfos.each do |iosignalenginfo| %>
            <tr>
              <%= render 'form', :iosignalenginfo => iosignalenginfo,
                         :iosignal => iosignalenginfo.iosignal,
                         :iosignal_tagname => iosignalenginfo.iosignal.tagname,
                         :iosignalenginfoid => iosignalenginfo.id %>
            </tr>
        <% end %>
        </tbody>
      </table>
    </div>
<% end %>


<%= link_to "Zurück zu Signale", project_subproject_subsubproject_iosignals_path(@project.id, @subproject.id, @subsubproject.id) %>

<script>

    $(document).ready ( function(){
        $('#iosignalenginfo_table').DataTable({
            "scrollX": true,
            'createdRow': function(row, data, dataIndex){
                $('td:eq(3)', row).css('min-width', '580px');
                $('td:eq(6)', row).css('min-width', '580px');
                $('td:eq(9)', row).css('min-width', '580px');
                $('td:eq(12)', row).css('min-width', '580px');
                $('td:eq(15)', row).css('min-width', '580px');
                $('td:eq(18)', row).css('min-width', '580px');
                $('td:eq(20)', row).css('min-width', '580px');
            },
            "pageLength": 10,
            "language": {
                "decimal":        "",
                "emptyTable":     "Keine Einträge gefunden",
                "info":           "Zeige _START_ bis _END_ von _TOTAL_ Einträgen",
                "infoEmpty":      "Zeige 0 bis 0 von 0 Einträgen",
                "infoFiltered":   "(gefiltert aus total _MAX_ Einträgen)",
                "lengthMenu":     "Zeige _MENU_ Einträge",
                "loadingRecords": "Lade Daten",
                "processing":     "Verarbeite...",
                "search":         "Suche",
                "zeroRecords":    "0 Einträge",
                "paginate": {
                    "first":      "Erster",
                    "last":       "Letzter",
                    "next":       "Nächste",
                    "previous":   "Vorherige"
                }
            }});

        // Disable all input fields and add 'edit'-button, except for first line.
        <% @iosignalenginfos.each_with_index do |iosignalenginfo, i| %>
          <% if i != 0 %>
            $("input.iosignalenginfo<%=iosignalenginfo.id %>_fld").attr("disabled", true);
          <% else %>
            $("a.iosignalenginfo<%=iosignalenginfo.id %>_edit").hide();
            $("input.iosignalenginfo<%=iosignalenginfo.id %>_fld").attr("disabled", false);
          <% end %>
        <% end %>

        // In case of using the browser back button! Rails duplicates html-elements when using this button
        // Hence, do reload page (only once!) by usage of a hidden input field!
        $('#loadingModal').modal('hide');
        var $input = $('#refresh');
        if ($input.val() == 'yes') {
            location.reload(true);
            loadingAlgorithm();
            $(".table-responsive").hide();
        }
        else {
            $input.val('yes');
        }
    });

    function editLine(id) {
        $("input.iosignalenginfo_fld").attr("disabled", true);
        $("a.iosignalenginfo_edit").show();
        $("a.iosignalenginfo" + id + "_edit").hide();
        $("input.iosignalenginfo" + id + "_fld").attr("disabled", false);
    }
</script>
